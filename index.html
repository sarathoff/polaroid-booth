<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Create nostalgic polaroid photos with filters, decorations, and captions in your browser.">
    <title>Polaroid Booth</title>

    <!-- Google Fonts (Updated to include new fonts) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=DM+Sans:wght@400;500;700&family=Caveat:wght@600;700&family=Patrick+Hand&family=Special+Elite&family=Rock+Salt&display=swap" rel="stylesheet">

    <style>
        :root {
            --font-sans: 'DM Sans', sans-serif;
            --font-display: 'Playfair Display', serif;
            --font-caveat: 'Caveat', cursive;
            --font-patrick-hand: 'Patrick Hand', cursive;
            --font-special-elite: 'Special Elite', cursive;
            --font-rock-salt: 'Rock Salt', cursive;
            --color-bg: #F4F1EC;
            --color-text: #413B35;
            --color-text-muted: #7A7269;
            --color-card-bg: #FDFCFB;
            --polaroid-bg: #FDFCFB; /* For JS access */
            --color-border: #DED8CF;
            --color-input-bg: #FFFFFF;
            --color-primary: #856f5c;
            --color-primary-dark: #6a5949;
            --color-primary-text: #FFFFFF;
            --color-secondary: #EBE6DE;
            --color-secondary-text: #59514A;
            --shadow-color: 23deg 15% 55%;
            --shadow-light: 0.3px 0.5px 0.7px hsl(var(--shadow-color) / 0.22), 0.4px 0.8px 1px -0.8px hsl(var(--shadow-color) / 0.22), 1px 2px 2.5px -1.7px hsl(var(--shadow-color) / 0.22);
            --shadow-medium: 0.3px 0.5px 0.7px hsl(var(--shadow-color) / 0.2), 0.8px 1.6px 2px -0.6px hsl(var(--shadow-color) / 0.2), 2.1px 4.1px 5.2px -1.1px hsl(var(--shadow-color) / 0.2), 5px 10px 12.6px -1.7px hsl(var(--shadow-color) / 0.2);
            --shadow-polaroid: 0 10px 20px rgba(60, 60, 80, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08);
            --radius-small: 6px;
            --radius-medium: 12px;
            --radius-large: 16px;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-sans);
            background-color: var(--color-bg);
            color: var(--color-text);
            background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="4" height="4" viewBox="0 0 4 4"%3E%3Cpath fill="%239C92AC" fill-opacity="0.06" d="M1 3h1v1H1V3zm2-2h1v1H3V1z"%3E%3C/path%3E%3C/svg%3E');
            line-height: 1.6;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        .l-container { max-width: 1200px; margin: 0 auto; padding: 1.5rem; }
        .header { text-align: center; margin-bottom: 2rem; }
        .header__logo { font-family: var(--font-display); font-size: 2rem; font-weight: 700; color: var(--color-primary); text-decoration: none; }

        main {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 2.5rem;
            align-items: flex-start;
        }

        .controls-panel { position: sticky; top: 1.5rem; }
        .preview-area { position: relative; min-height: 80vh; display: flex; align-items: center; justify-content: center; }

        .c-btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
            padding: 0.65rem 1rem; font-family: var(--font-sans); font-weight: 500;
            font-size: 0.9rem; border-radius: var(--radius-small); border: 1px solid transparent;
            cursor: pointer; transition: all 0.2s ease-out; white-space: nowrap;
        }
        .c-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; box-shadow: none !important; }
        .c-btn--primary { background-color: var(--color-primary); color: var(--color-primary-text); border-color: var(--color-primary); box-shadow: var(--shadow-light); }
        .c-btn--primary:not(:disabled):hover, .c-btn--primary:not(:disabled):focus { background-color: var(--color-primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-medium); }
        .c-btn--secondary { background-color: var(--color-secondary); color: var(--color-secondary-text); border-color: var(--color-border); }
        .c-btn--secondary:not(:disabled):hover, .c-btn--secondary:not(:disabled):focus { background-color: #e0d9cf; border-color: #cec5b9; }
        .c-btn svg { width: 16px; height: 16px; }

        .c-card {
            background-color: var(--color-card-bg); border: 1px solid var(--color-border);
            border-radius: var(--radius-large); padding: 1.5rem; box-shadow: var(--shadow-light);
            display: flex; flex-direction: column; gap: 1.25rem;
        }
        .c-card__section { display: flex; flex-direction: column; gap: 1rem; }
        .c-card__section-title { font-size: 0.8rem; font-weight: 700; color: var(--color-text-muted); margin-bottom: -0.25rem; text-transform: uppercase; letter-spacing: 0.5px; }
        
        .c-video-container { position: relative; aspect-ratio: 16 / 9; border-radius: var(--radius-medium); overflow: hidden; background-color: var(--color-secondary); }
        #videoElement { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }
        #cameraOverlay { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,0,0,0.4); color: white; font-size: 0.9rem; text-align: center; padding: 1rem; gap: 1rem; }

        .c-option-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(60px, 1fr)); gap: 0.75rem; }
        .grid-option {
            display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 0.5rem;
            border: 2px solid transparent; border-radius: var(--radius-medium); background-color: var(--color-input-bg);
            cursor: pointer; transition: all 0.2s; border: 1px solid var(--color-border); text-align: center;
        }
        .grid-option:hover { border-color: var(--color-primary); transform: translateY(-2px); }
        .grid-option.active { border-color: var(--color-primary); box-shadow: 0 0 0 2px var(--color-primary); }
        .option-name { font-size: 0.7rem; font-weight: 500; color: var(--color-text-muted); }

        .layout-icon {
            width: 32px;
            height: 32px;
            object-fit: contain;
        }

        .filter-preview { width: 100%; height: 40px; border-radius: var(--radius-small); background-size: cover; background-position: center; }
        .font-preview { font-size: 1.5rem; line-height: 1; }
        .font-Caveat { font-family: var(--font-caveat); }
        .font-Patrick-Hand { font-family: var(--font-patrick-hand); }
        .font-Special-Elite { font-family: var(--font-special-elite); }
        .font-Rock-Salt { font-family: var(--font-rock-salt); }
        .decoration-preview { width: 40px; height: 40px; background-size: contain; background-repeat: no-repeat; background-position: center; }

        .c-input-group { display: flex; flex-direction: column; gap: 0.25rem; }
        .c-label { font-size: 0.8rem; font-weight: 500; color: var(--color-text-muted); }
        .c-input {
            width: 100%; padding: 0.6rem 0.75rem; border-radius: var(--radius-small); border: 1px solid var(--color-border);
            background-color: var(--color-input-bg); font-family: var(--font-sans); font-size: 0.9rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .c-input:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 2px color-mix(in srgb, var(--color-primary) 30%, transparent); }

        #emptyState { text-align: center; color: var(--color-text-muted); }
        #emptyState svg { width: 4rem; height: 4rem; margin: 0 auto 1rem; opacity: 0.4; }
        #emptyState h3 { font-family: var(--font-display); font-size: 1.5rem; margin-bottom: 0.5rem; color: var(--color-text); }
        
        /* Preview Area Styles */
        .polaroid-output-area, .polaroid-grid-wrapper { perspective: 1500px; }
        .polaroid {
            background: var(--polaroid-bg); border-radius: 4px; box-shadow: var(--shadow-polaroid);
            transition: transform 0.4s ease, box-shadow 0.4s ease; position: relative;
        }
        .polaroid-image-wrapper { background-color: #e0e5f1; aspect-ratio: 1/1; overflow: hidden; }
        .polaroid-image { display: block; width: 100%; height: 100%; object-fit: cover; }
        .polaroid-text { text-align: center; padding: 0.5rem; color: #444; overflow-wrap: break-word; }
        
        .polaroid-output-area { width: 350px; }
        #polaroid-single { padding: 1rem 1rem 4rem; transform: rotate(-2deg); }
        #polaroid-single .polaroid-image-wrapper { margin-bottom: 1.25rem; }
        #polaroid-single .polaroid-text { font-size: 1.5rem; }

        .polaroid-grid-wrapper { display: grid; max-width: 550px; gap: 1.5rem; }
        .polaroid-grid-wrapper.grid-2x2 { grid-template-columns: 1fr 1fr; }
        .polaroid-grid-wrapper.grid-strip, .polaroid-grid-wrapper.grid-4x1 { grid-template-columns: 1fr; max-width: 250px; }
        .polaroid-grid-wrapper .polaroid { width: 100%; padding: 0.75rem 0.75rem 2.5rem; }
        .polaroid-grid-wrapper .polaroid:nth-child(odd) { transform: rotate(-2.5deg); }
        .polaroid-grid-wrapper .polaroid:nth-child(even) { transform: rotate(2.5deg); }
        .polaroid-grid-wrapper .polaroid-image-wrapper { margin-bottom: 0.75rem; }
        .polaroid-grid-wrapper .polaroid-text { font-size: 1.2rem; }

        .decoration { position: absolute; background-size: contain; background-repeat: no-repeat; pointer-events: none; z-index: 10; }
        .deco-ribbon-decoration { top: 0; left: 0; }
        .deco-heart-decoration { top: 0; right: 0; }

        .filter-vintage { filter: sepia(0.35) contrast(1.1) brightness(1.05) saturate(1.2); }
        .filter-mono { filter: grayscale(1); }
        .filter-retro { filter: sepia(0.6) contrast(0.9) brightness(1.1); }
        .filter-gloomy { filter: contrast(1.2) brightness(0.9) saturate(0.8); }
        .filter-mellow { filter: brightness(1.1) contrast(0.95) saturate(0.9); }
        .filter-dreamy { filter: saturate(1.4) contrast(0.9) brightness(1.1) blur(0.5px); }
        .filter-lomo { filter: saturate(1.5) contrast(1.2); }

        .hidden { display: none !important; }
        canvas#canvas { display: none; }

        /* Overlays & Effects */
        .flash-effect { position: fixed; inset: 0; background: white; opacity: 0; pointer-events: none; z-index: 9999; }
        .flash-effect.active { animation: flash 0.3s ease-out; }
        @keyframes flash { 0% { opacity: 0; } 50% { opacity: 0.9; } 100% { opacity: 0; } }

        #countdownOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center;
            z-index: 10000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; backdrop-filter: blur(4px);
        }
        #countdownOverlay.is-active { opacity: 1; pointer-events: all; }
        #countdownNumber {
            font-family: var(--font-display); font-size: 10rem; font-weight: 700; color: white;
            text-shadow: 0 4px 20px rgba(0,0,0,0.5); transform-origin: center;
        }

        /* Download Button Spinner */
        .spinner {
            width: 18px; height: 18px; border: 2px solid rgba(255,255,255,0.3);
            border-top-color: var(--color-primary-text); border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 992px) {
            main { grid-template-columns: 1fr; }
            .controls-panel { position: static; max-width: 500px; margin: 0 auto; }
            .preview-area { min-height: auto; padding-top: 2rem; }
        }
        @media (max-width: 480px) {
            .polaroid-output-area, .polaroid-grid-wrapper { width: 100%; max-width: 100%; }
            .polaroid-grid-wrapper.grid-2x2 { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Overlays -->
    <div id="flashEffect" class="flash-effect"></div>
    <div id="countdownOverlay" aria-live="polite">
        <div id="countdownNumber"></div>
    </div>

    <div class="l-container">
        <header class="header">
            <a href="landing.html" class="header__logo" aria-label="The Timeless Photo Booth Home">Polaroid Booth</a>
        </header>

        <main>
            <!-- CONTROLS PANEL -->
            <aside class="controls-panel">
                <div class="c-card">
                    <!-- 2. LAYOUT & TIMER -->
                    <div class="c-card__section">
                        <div class="c-card__section-title">Layout & Timer</div>
                        <div id="layoutOptions" class="c-option-grid" role="radiogroup">
                             <div class="grid-option layout-option" data-layout="single">
                                <img src="assets/layout-single.svg" alt="Single Photo Layout" class="layout-icon">
                                <span class="option-name">Single</span>
                            </div>
                            <div class="grid-option layout-option" data-layout="grid-2x2">
                                <img src="assets/layout-grid.svg" alt="2x2 Grid Layout" class="layout-icon">
                                <span class="option-name">2x2 Grid</span>
                            </div>
                            <div class="grid-option layout-option" data-layout="grid-strip">
                                <img src="assets/layout-strip.svg" alt="Photo Strip Layout" class="layout-icon">
                                <span class="option-name">Strip</span>
                            </div>
                        </div>
                         <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="c-input-group">
                                <label class="c-label" for="timerDelay">Delay (s)</label>
                                <input type="number" id="timerDelay" min="1" max="10" value="3" class="c-input">
                            </div>
                            <div class="c-input-group">
                                <label class="c-label" for="photoCount">Photos</label>
                                <input type="number" id="photoCount" min="1" max="4" value="4" class="c-input">
                            </div>
                        </div>
                        <button class="c-btn c-btn--secondary" id="startTimerBtn" disabled>Start Timer</button>
                        <div id="timerStatus" style="font-size: 0.8rem; text-align: center; color: var(--color-text-muted);"></div>
                    </div>

                    <!-- 1. CAMERA & CAPTURE -->
                    <div class="c-card__section">
                        <div class="c-video-container">
                            <video id="videoElement" autoplay muted playsinline aria-label="Live camera feed"></video>
                            <div id="cameraOverlay" role="alert">Click "Start Camera" to begin</div>
                        </div>
                        <button class="c-btn c-btn--primary" id="startCameraBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>
                            Start Camera
                        </button>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <button class="c-btn c-btn--secondary" id="captureBtn" disabled>Capture</button>
                            <button class="c-btn c-btn--secondary" id="uploadBtn">Upload</button>
                        </div>
                        <input type="file" id="fileInput" accept="image/*" class="hidden">
                        <button class="c-btn c-btn--secondary" id="switchCameraBtn" disabled>Switch Camera</button>
                    </div>

                    
                    
                    <!-- 3. CUSTOMIZATION -->
                    <div class="c-card__section">
                        <div class="c-card__section-title">Image Filter</div>
                        <div class="c-option-grid" id="filterOptions" role="radiogroup"></div>
                    </div>
                    <div class="c-card__section">
                        <div class="c-card__section-title">Font Style</div>
                        <div class="c-option-grid" id="fontOptions" role="radiogroup"></div>
                    </div>
                     <div class="c-card__section">
                        <div class="c-card__section-title">Decorations</div>
                        <div class="c-option-grid" id="decorationOptions"></div>
                    </div>

                    <!-- 4. FINAL TOUCHES -->
                    <div class="c-card__section" style="padding-top: 1rem; border-top: 1px solid var(--color-border);">
                        <div class="c-card__section-title">Add A Caption</div>
                        <input type="text" id="polaroidText" placeholder="Write a memory..." maxlength="60" class="c-input">
                        <button class="c-btn c-btn--primary" id="downloadBtn" disabled>
                            <span class="btn-text">Download Image</span>
                            <div class="spinner hidden"></div>
                        </button>
                    </div>
                </div>
            </aside>

            <!-- PREVIEW AREA -->
            <section class="preview-area" aria-live="polite">
                <div id="polaroidContainer">
                    <div id="emptyState">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
                            <circle cx="9" cy="9" r="2"/>
                            <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
                        </svg>
                        <h3>Your Photos Appear Here</h3>
                        <p>Start your camera or upload an image to begin.</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <canvas id="canvas" aria-hidden="true"></canvas>

    <script src="app.js"></script>
</body>
</html>